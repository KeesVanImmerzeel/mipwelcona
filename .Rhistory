sl_fltr_table,
conc_streamlines) {
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
well_filters=chk_mw_read_well_filters
head(well_filters)
sl_fltr_table=chk_sl_fltr_table
conc_streamlines=chk_mw_conc_streamlines
head(sl_fltr_table)
chk_mw_read_well_filters
well_fltrs=,chk_mw_read_well_filters
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
flt_nrs <- well_fltrs %>% dplyr::filter(well_nr == FLTR_NR )
return(flt_nrs)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
.mw_conc_well(1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
well_fltrs=chk_mw_read_well_filters
.mw_conc_well(1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
head(chk_mw_read_well_filters)
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
flt_nrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
return(flt_nrs)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
.mw_conc_well(1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
return(well_fltrs)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
.mw_conc_well(1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
nrow(well_fltrs)
?purrrlyr::by_row()
str(well_fltrs)
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
if (nrow(well_fltrs)<1) {
return(NA)
}
conc <-
purrrlyr::by_row( well_fltrs, sl_fltr_table=sl_fltr_table, conc_streamlines=conc_streamlines, .collate="cols")
return(conc)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
.mw_conc_well(1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
if (nrow(well_fltrs)<1) {
return(NA)
}
conc <-
purrrlyr::by_row( well_fltrs, ..f=.mw_conc_fltr,sl_fltr_table=sl_fltr_table, conc_streamlines=conc_streamlines, .collate="cols")
return(conc)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
.mw_conc_well(1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x <- .mw_conc_well(1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
head(x)
x$CONC1
x <- .mw_conc_fltr( fltr_nr=1, sl_fltr_table=chk_sl_fltr_table, conc_streamlines=chk_mw_conc_streamlines)
x
# @export
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
if (nrow(well_fltrs)<1) {
return(NA)
}
conc <-
purrrlyr::by_row( well_fltrs, ..f=.mw_conc_fltr,sl_fltr_table=sl_fltr_table, conc_streamlines=conc_streamlines, .collate="cols", .labels=FALSE)
return(conc)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
x <- .mw_conc_fltr( fltr_nr=1, sl_fltr_table=chk_sl_fltr_table, conc_streamlines=chk_mw_conc_streamlines)
x
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
if (nrow(well_fltrs)<1) {
return(NA)
}
conc <-
purrrlyr::by_row( well_fltrs, ..f=.mw_conc_fltr,sl_fltr_table=sl_fltr_table, conc_streamlines=conc_streamlines, .collate="cols", .labels=FALSE)
return(conc)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
x <- .mw_conc_fltr( fltr_nr=1, sl_fltr_table=chk_sl_fltr_table, conc_streamlines=chk_mw_conc_streamlines)
x
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
if (nrow(well_fltrs)<1) {
return(NA)
}
conc <-
purrrlyr::by_row( well_fltrs, ..f=.mw_conc_fltr,sl_fltr_table=sl_fltr_table, conc_streamlines=conc_streamlines, .collate="cols")
return(conc)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
x <- .mw_conc_fltr( fltr_nr=1, sl_fltr_table=chk_sl_fltr_table, conc_streamlines=chk_mw_conc_streamlines)
x
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
if (nrow(well_fltrs)<1) {
return(NA)
}
conc <-
purrrlyr::by_row( well_fltrs, ..f=.mw_conc_fltr,sl_fltr_table=sl_fltr_table, conc_streamlines=conc_streamlines, .collate="cols")
return(conc)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
x <- .mw_conc_fltr( fltr_nr=1, sl_fltr_table=chk_sl_fltr_table, conc_streamlines=chk_mw_conc_streamlines)
x
well_fltrs=chk_mw_read_well_filters
x <- .mw_conc_fltr( fltr_nr=1, sl_fltr_table=chk_sl_fltr_table, conc_streamlines=chk_mw_conc_streamlines)
x
well_fltrs=chk_mw_read_well_filters
head(well_fltrs)
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
well_nr=1
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
well_fltrs
.mw_conc_well <-
function(well_nr=1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr )
if (nrow(well_fltrs)<1) {
return(NA)
}
conc <-
purrrlyr::by_row( well_fltrs, ..f=.mw_conc_fltr,sl_fltr_table=sl_fltr_table, conc_streamlines=conc_streamlines, .collate="cols")
return(conc)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
x <- .mw_conc_fltr( fltr_nr=1, sl_fltr_table=chk_sl_fltr_table, conc_streamlines=chk_mw_conc_streamlines)
x
purrrlyr::by_row( well_fltrs, ..f=.mw_conc_fltr,sl_fltr_table=sl_fltr_table, conc_streamlines=conc_streamlines, .collate="cols")
head(purrrlyr::by_row( well_fltrs, ..f=.mw_conc_fltr,sl_fltr_table=sl_fltr_table, conc_streamlines=conc_streamlines, .collate="cols"))
load_all()
library(devtools)
well_nr=1
well_fltrs=chk_mw_read_well_filters
load_all()
well_fltrs=chk_mw_read_well_filters
sl_fltr_table=chk_sl_fltr_table
conc_streamlines=chk_mw_conc_streamlines
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
names(x)
head(x)
x$TIME
x$CONC
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
fname <- system.file("extdata","well_filters.ipf",package="mipwelcona")
well_fltrs <- mw_read_well_filters(fname)
well_fltrs
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
?weighted.mean
?dplyr::weighted.mean
wt <- c(5,  5,  4,  1)/15
x <- c(3.7,3.3,3.5,2.8)
xm <- weighted.mean(x, wt)
xm
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
load_all()
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
well_fltrs=chk_mw_read_well_filters
sl_fltr_table=chk_sl_fltr_table
conc_streamlines=chk_mw_conc_streamlines
x <- .mw_conc_well (1,
well_fltrs,
sl_fltr_table,
conc_streamlines)
x
well_fltrs=chk_mw_read_well_filters
sl_fltr_table=chk_sl_fltr_table
conc_streamlines=chk_mw_conc_streamlines
.mw_conc_well <-
function(well_nr = 1,
well_fltrs,
sl_fltr_table,
conc_streamlines) {
well_fltrs <- well_fltrs %>% dplyr::filter(WL_NR == well_nr)
if (nrow(well_fltrs) < 1) {
return(NA)
}
conc <-
purrrlyr::by_row(
well_fltrs,
..f = .mw_conc_fltr,
sl_fltr_table = sl_fltr_table,
conc_streamlines = conc_streamlines,
.collate = "rows"
) %>% dplyr::select(FLTR_NR, Q_FLTR, TIME, CONC) %>%
dplyr::group_by(TIME) %>%
dplyr::summarise(WCONC = weighted.mean(CONC, Q_FLTR))
return(conc)
#    sl_nrs <-
#      sl_fltr_table %>% dplyr::filter(FLTR_NR == fltr_nr) %>% dplyr::select(SL_NR) %>% dplyr::pull(1)
#    if (length(sl_nrs) < 1) {
#      return(NA)
#    }
#    conc_streamlines %<>% dplyr::filter(SL_NR %in% sl_nrs)
#    df <-
#      conc_streamlines %>% dplyr::group_by(TIME) %>% dplyr::summarize(CONC =
#                                                                        mean(CONC), .groups = "drop")
#    return(cbind(FLTR_NR = fltr_nr, df))
}
library(devtools)
load_all()
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
load_all()
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
load_all()
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
well_fltrs=chk_mw_read_well_filters
sl_fltr_table=chk_sl_fltr_table
conc_streamlines=chk_mw_conc_streamlines
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
load_all()
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, well_fltrs=chk_mw_read_well_filters, sl_fltr_table=chk_sl_fltr_table,
conc_streamlines=chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, chk_mw_read_well_filters, chk_sl_fltr_table,
chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, chk_mw_read_well_filters, chk_sl_fltr_table,
chk_mw_conc_streamlines )
x
x <- .mw_conc_well( 1, chk_mw_read_well_filters, chk_sl_fltr_table,
chk_mw_conc_streamlines )
x
document()
document()
document()
document()
head(chk_mw_read_well_filters)
load_all()
x <- .mw_conc_well( 1, chk_mw_read_well_filters, chk_sl_fltr_table,
chk_mw_conc_streamlines )
x
load_all()
x <- .mw_conc_well( 1, chk_mw_read_well_filters, chk_sl_fltr_table,
chk_mw_conc_streamlines )
x
document()
